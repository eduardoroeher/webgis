<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preenchimento Automático WebGIS</title>
</head>
<body>

    <h1>Teste de Preenchimento Automático</h1>

    <script>
        (function() {
            'use strict';
            
            // Exibe uma mensagem de Olá Mundo no console
            console.log("Olá Mundo!");

            // Função principal para preencher todos os campos
            function preencherCampos() {
                preencherObservacao();
                preencherOperadorCQ();
                preencherRevisao();
                preencherDataModificacao();
            }

            // Função para preencher o campo "Observação"
            function preencherObservacao() {
                var campoObservacao = document.querySelector('textarea[aria-label="Observação"]');
                if (campoObservacao) {
                    if (campoObservacao.value.trim() === "") {
                        campoObservacao.value = "Número de porta:";
                        dispararEventos(campoObservacao);
                        console.log("Campo 'Observação' preenchido com sucesso!");
                    } else {
                        console.log("Campo 'Observação' já possui valor, não será preenchido automaticamente.");
                    }
                } else {
                    console.log("Campo 'Observação' não encontrado!");
                }
            }

            // Função para preencher o campo "Operador CQ"
            function preencherOperadorCQ() {
                var campoOperadorCQ = document.querySelector('input[aria-label="Operador CQ"]');
                if (campoOperadorCQ) {
                    campoOperadorCQ.value = "Revisar Observação OK";
                    dispararEventos(campoOperadorCQ);
                    console.log("Campo 'Operador CQ' preenchido com sucesso!");
                } else {
                    console.log("Campo 'Operador CQ' não encontrado!");
                }
            }

            // Função para preencher o campo "Revisão"
            function preencherRevisao() {
                var campoRevisao = document.querySelector('input[aria-label="Revisão"]');
                if (campoRevisao) {
                    campoRevisao.value = "Eduardo R";
                    dispararEventos(campoRevisao);
                    console.log("Campo 'Revisão' preenchido com sucesso!");
                } else {
                    console.log("Campo 'Revisão' não encontrado!");
                }
            }

            // Função para preencher o campo de "Data de Modificação"
            function preencherDataModificacao() {
                var campoDataModificacao = document.querySelector('input[aria-label="Data da Modificação"]');
                if (campoDataModificacao) {
                    var dataAtual = new Date();
                    var dataFormatada = formatarData(dataAtual);
                    campoDataModificacao.value = dataFormatada;
                    dispararEventos(campoDataModificacao);
                    console.log("Campo 'Data da Modificação' preenchido com sucesso!");
                } else {
                    console.log("Campo 'Data da Modificação' não encontrado!");
                }
            }

            // Função para formatar a data no formato dd/mm/aaaa
            function formatarData(data) {
                var dia = ("0" + data.getDate()).slice(-2);
                var mes = ("0" + (data.getMonth() + 1)).slice(-2);
                var ano = data.getFullYear();
                return dia + '/' + mes + '/' + ano;
            }

            // Função para disparar eventos de mudança, foco e input
            function dispararEventos(campo) {
                campo.focus();
                var eventoInput = new Event('input', { bubbles: true });
                campo.dispatchEvent(eventoInput);
                var eventoChange = new Event('change', { bubbles: true });
                campo.dispatchEvent(eventoChange);
                campo.blur();
            }

            // Simulação de evento de clique com o botão direito para disparar o preenchimento
            document.addEventListener('mousedown', function(event) {
                if (event.button === 2) {
                    event.preventDefault();
                    preencherCampos();
                }
            });

        })();
    </script>

</body>
</html>
